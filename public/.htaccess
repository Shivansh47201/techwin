# Techwin Hostinger Static Export Configuration
# This .htaccess file fixes 403 Forbidden errors and ensures proper routing for the `out` folder

# ==========================================
# ENABLE MOD_REWRITE
# ==========================================
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Set RewriteBase to your domain root (adjust if in subdirectory)
    RewriteBase /
    
    # ==========================================
    # FIX: 403 Forbidden - Access Control
    # ==========================================
    # Disable directory listing
    <IfModule mod_autoindex.c>
        Options -Indexes
    </IfModule>
    
    # Allow access to all files and directories
    <FilesMatch ".*">
        Order allow,deny
        Allow from all
    </FilesMatch>
    
    # ==========================================
    # STATIC FILES CACHING
    # ==========================================
    # Cache static assets for 1 year
    <FilesMatch "\.(jpg|jpeg|png|gif|webp|ico|css|js|woff|woff2|ttf|svg|eot)$">
        Header set Cache-Control "public, max-age=31536000, immutable"
        Header set Access-Control-Allow-Origin "*"
    </FilesMatch>
    
    # Don't cache HTML (revalidate always)
    <FilesMatch "\.html?$">
        Header set Cache-Control "public, no-cache, must-revalidate, max-age=3600"
    </FilesMatch>
    
    # ==========================================
    # SPA ROUTING - RewriteRules
    # ==========================================
    # Don't rewrite if it's a real file
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]
    
    # Rewrite all requests to index.html (for SPA routing)
    # But first check for exact HTML files
    RewriteCond %{REQUEST_URI} !^/index\.html$
    RewriteCond %{REQUEST_FILENAME}\.html -f
    RewriteRule ^(.*)$ $1.html [L]
    
    # Route everything else to index.html
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^ index.html [QSA,L]
</IfModule>

# ==========================================
# CHARSET & ENCODING
# ==========================================
AddDefaultCharset utf-8
<FilesMatch "\.js$">
    AddCharset utf-8 .js
</FilesMatch>
<FilesMatch "\.css$">
    AddCharset utf-8 .css
</FilesMatch>

# ==========================================
# GZIP COMPRESSION (if available)
# ==========================================
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
    AddOutputFilterByType DEFLATE font/opentype font/truetype font/eot application/font-woff
</IfModule>

# ==========================================
# SECURITY HEADERS
# ==========================================
<IfModule mod_headers.c>
    # Prevent clickjacking
    Header set X-Frame-Options "SAMEORIGIN"
    
    # Prevent MIME type sniffing
    Header set X-Content-Type-Options "nosniff"
    
    # Enable XSS protection
    Header set X-XSS-Protection "1; mode=block"
    
    # Allow CORS for fonts
    <FilesMatch "\.(woff|woff2|ttf|otf|eot)$">
        Header set Access-Control-Allow-Origin "*"
    </FilesMatch>
</IfModule>

# ==========================================
# FIX: Remove index.html from URLs
# ==========================================
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /index\.html\ HTTP
RewriteRule ^index\.html$ / [R=301,L]

# ==========================================
# FIX: Remove .html extension from URLs (optional)
# ==========================================
# Uncomment if you want /about instead of /about.html
# RewriteCond %{REQUEST_FILENAME} !-f
# RewriteCond %{REQUEST_FILENAME}\.html -f
# RewriteRule ^([^\.]+)$ $1.html [L]

# ==========================================
# REDIRECT HTTP TO HTTPS (uncomment if needed)
# ==========================================
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
